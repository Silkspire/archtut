#create 512M partition: type ef00 (efi)
#create 2nd partition for rest of Linux
cfdisk /dev/sdX
#build FAT32
mkfs.fat -F32 /dev/sdX1
#build ext4 on other
mkfs.ext4 /dev/sdX2
#mount the large ext4 partition
mount /dev/sdX2 /mnt
#make boot directory
mkdir /mnt/boot
#mount efi partition to boot directory
mount /dev/sdX1 /mnt/boot
#install base system (takes a bit)
pacstrap /mnt base base-devel
#generate fstab
genfstab -U /mnt > /mnt/etc/fstab

#here is where you would install a bootloader, but fuck that
#UEFI is magical
#Also pass intel_iommu=on for passthrough
efibootmgr -d /dev/sdX -p 1 -c -L "Arch Linux" -l /vmlinuz-linux -u "root=/dev/sdX2 rw initrd=initramfs-linux.img intel_iommu=on"
#remove bootable media, restart.
reboot

#login as root, set root password
passwd
#set hostname
echo hostnameYouWant > /etc/hostname
#add new user & set password
useradd -m -G wheel -g users usernameYouWant
passwd usernameYouWant
#edit sudoers to allow new user to sudo
EDITOR=nano visudo
    ##Uncomment to allow memebers of group..
    %wheel ALL=(ALL) ALL

#check name of network interface
ip link

###Shitty dynamic IP settings on startup as daemon, don't use if advanced
###systemctl enable dhcpcd@{NETINTERFACENAME}.service (enp#s#)
###systemctl start dhcpcd@{NETINTERFACENAME}.service (enp#s#)

#generate new locales & set one system wide
locale-gen
localectl set-locale LANG=en_US.UTF-8
#selectt timezone and set it permanent
tzselect
timedatectl set-timezone 'Europe/City'
#set hardware clock and sync using ntp
hwclock --systohc --utc
timedatectl set-ntp true

###swap file if you want
###fallocate -l 2G /swapfile
###chmod 600 /swapfile
###mkswap /swapfile
###nano /etc/fstab  (/swapfile none swap defaults 0 0)
###nano /etc/sysctl.d/99-sysctl.conf (vm.swappiness=10)

#enable color and x86 repo in pacman.conf
nano /etc/pacman.conf
  # Misc options
  Color
  [multilib]
  Include = /etc/pacman.d/mirrorlist

#sync repos and reboot
#start internet for this
#systemctl start dhcpcd@{NETINTERFACENAME}.service (enp#s#)
pacman -Sy
reboot

#login as normal user, sudo everything
#install default video driver
pacman - S xf86-video-vesa
#install OpenGL support
pacman -S mesa
#install video driver ospecific for your hardware
pacman -S xf86-video-intel lib32-mesa-libgl
#install Xorg packages
pacman -S xorg-server xorg-utils xorg-xinit

#install DE of choice (pacman -S)
Xfce      xfce4 xfce4-goodies
GNOME     gnome gnome-extra
KDE       plasma kde-applications
Cinnamon  cinnamon
MATE      mate mate-extra
LXDE      lxde
LXQt      lxqt

#install & enable login manager
#GDM (gnome)
  pacman -S GDM
  systemctl enable gdm.service
#LightDM
  pacman -S lightdm-gtk-greeter
  systemctl enable lightdm.service

reboot
